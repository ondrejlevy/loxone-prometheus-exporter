# Loxone Prometheus Exporter Configuration
# See contracts/config-schema.md for full reference.

# Required: List of Miniserver connections
miniservers:
  - name: "home"                      # Unique label → Prometheus `miniserver` label
    host: "192.168.1.100"             # IP or hostname of the Miniserver
    port: 80                          # WebSocket port for unencrypted connections (default: 80)
    ssl_port: 443                     # WebSocket port for encrypted connections (default: 443)
    username: "prometheus"            # Loxone user (overridable: LOXONE_USERNAME)
    password: "your-password-here"    # Loxone password (overridable: LOXONE_PASSWORD)
    use_encryption: false             # Use wss:// instead of ws:// (default: false)
    force_encryption: false           # Require encryption, fail if not available (default: false)
                                      # Note: Miniserver 2 (Gen2) will auto-enable encryption on ssl_port

  # Uncomment for multiple Miniservers:
  # - name: "office"
  #   host: "192.168.1.101"
  #   port: 80
  #   ssl_port: 443
  #   username: "prometheus"
  #   password: "office-password"
  #   use_encryption: true            # Force encryption for this Miniserver

# HTTP server configuration
listen_port: 9504                     # Port for /metrics and /healthz (default: 9504)
listen_address: "0.0.0.0"            # Bind address (default: 0.0.0.0)

# Logging configuration
log_level: "info"                     # debug, info, warning, error (default: info)
log_format: "json"                    # json or text (default: json)

# Filtering — exclude controls from metrics export
exclude_rooms: []                     # Room names to exclude, e.g. ["Test Room", "Utility"]
exclude_types: []                     # Control types to exclude, e.g. ["Pushbutton", "Webpage"]
exclude_names: []                     # Glob patterns to exclude, e.g. ["Test*", "Debug_*"]

# Text control handling
include_text_values: false            # Export text-only controls as info metrics (default: false)

# OpenTelemetry OTLP export (optional)
# Pushes metrics to an OTLP collector alongside Prometheus scraping.
# opentelemetry:
#   enabled: false                     # Enable/disable OTLP export (default: false)
#   endpoint: "http://localhost:4317"  # OTLP collector URL (required if enabled)
#   protocol: grpc                     # 'grpc' or 'http' (default: grpc)
#   interval_seconds: 30               # Export interval in seconds 10-300 (default: 30)
#   timeout_seconds: 15                # Export timeout in seconds 5-60 (default: 15)
#   tls:
#     enabled: false                   # Enable TLS (default: false)
#     cert_path: null                  # Path to CA certificate file
#   auth:
#     headers:                         # Authentication headers (optional)
#       Authorization: "Bearer token"
#       X-API-Key: "your-key"
# Example: Direct export to Grafana Cloud (no separate collector needed)
# Uncomment and configure the following section to send metrics to Grafana Cloud:
# opentelemetry:
#   enabled: true
#   endpoint: "https://otlp-gateway-prod-<YOUR-REGION>.grafana.net/otlp"  # Get from Grafana Cloud Portal
#   protocol: http                                                         # Grafana Cloud uses HTTP/protobuf
#   interval_seconds: 60                                                   # Export every 60 seconds
#   timeout_seconds: 30
#   auth:
#     headers:
#       Authorization: "Basic%20<YOUR-BASE64-ENCODED-TOKEN>"               # Note: Use 'Basic%20' (not 'Basic ')